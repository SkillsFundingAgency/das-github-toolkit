Import-Module $PSScriptRoot\..\src\GitHubToolKit.psm1 -Force

Describe "Set-GitHubRepoVulnerabilitySetting tests" -Tags @("Unit") {
    Context "All mandatory parameters are passed" {
        Mock Invoke-GitHubRestMethod -ModuleName GitHubToolKit -MockWith { Return $null }
        It "All mandatory parameters are passed" {
            Set-GitHubSessionInformation -PatToken "not-a-real-pat-token"
            { Set-GitHubRepoVulnerabilitySetting -GitHubOrg "FooBarAgency" -RepoPrefix "foo-" -ExcludedRepoPrefix "bar-" } | Should not throw
        }
    }
}
